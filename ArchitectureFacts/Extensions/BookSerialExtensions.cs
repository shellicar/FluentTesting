using System;
using Architecture;
using Core;
using FluentFixture;

namespace ArchitectureFacts.Extensions
{
    /// <summary>
    /// Extension methods to build BookSerial objects fluently.
    /// </summary>
    internal static class BookSerialExtensions
    {
        /// <summary>
        /// Builds a BookSerial with a given text group.
        /// </summary>
        /// <param name="builder">The builder.</param>
        /// <param name="group">The group.</param>
        /// <returns>the updated builder.</returns>
        public static FixtureBuilder<BookSerial> WithGroup(this FixtureBuilder<BookSerial> builder, string group)
        {
            builder.AddMethod(x =>
            {
                x.Add(group);
                return x;
            });
            return builder;
        }

        /// <summary>
        /// Builds a BookSerial with a value that is considered valid.
        /// </summary>
        /// <param name="builder">The builder.</param>
        /// <returns>the updated builder.</returns>
        public static FixtureBuilder<BookSerial> Valid(this FixtureBuilder<BookSerial> builder)
        {
            var validSerial = "123-12345-1234";

            builder.AddMethod(x => BookSerial.Parse(validSerial));
            return builder;
        }

        /// <summary>
        /// Builds a BookSerial with the specified group replaced with the new value.
        /// </summary>
        /// <param name="builder">The builder.</param>
        /// <param name="group">The group.</param>
        /// <param name="value">The value.</param>
        /// <returns>the updated builder.</returns>
        public static FixtureBuilder<BookSerial> SetGroup(this FixtureBuilder<BookSerial> builder, int group, string value)
        {
            builder.AddMethod(x =>
            {
                x.Edit(group, value);
                return x;
            });
            return builder;
        }

        /// <summary>
        /// Whens the validate.
        /// </summary>
        /// <param name="builder">The builder.</param>
        /// <param name="validator">The validator.</param>
        /// <returns></returns>
        /// <autogeneratedoc />
        /// TODO Edit XML Comment Template for WhenValidate
        public static FixtureBuilder<BookSerial> WhenValidate(this FixtureBuilder<BookSerial> builder, IBookSerialValidator validator)
        {
            void When(BookSerial x)
            {
                validator.Validate(x.ToString());
            }

            builder.When(When);
            return builder;
        }
    }
}